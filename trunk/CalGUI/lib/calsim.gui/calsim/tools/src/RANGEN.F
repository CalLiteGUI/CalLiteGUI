cc      INTEGER FUNCTION RANGEN											!DLL ONLY
cc	!DEC$ ATTRIBUTES DLLEXPORT :: RANGEN								!DLL ONLY
cc	!DEC$ ATTRIBUTES C,DECORATE,ALIAS : 'RANGEN' :: RANGEN				!DLL ONLY
      SUBROUTINE RANGEN(FILE_PATH)														!EXE ONLY
C	THIS PROGRAM IS TO BE USED IN CALSIM ENGINE TO RANDOMLY SELECT 
C	A YEAR BETWEEN 1922 AND 2006 AS THE 2ND YEAR OF THE TWO YEAR 
C	POSITION ANALYSIS 
C	AUTHOR: HONGBING YIN, MODELING SUPPORT BRANCH, BAY-DELTA OFFICE
C	DATE: JULY 6, 2010
C	CALIFORNIA DEPARTMENT OF WATER RESOURCES
      INTEGER IYEAR2
	REAL RNUMBER
	CHARACTER*(*), INTENT(IN) :: FILE_PATH
	OPEN(5,FILE=FILE_PATH,STATUS='UNKNOWN')
	WRITE(5,100)
	CALL RANDOM_SEED ()
	DO 10 I=1,85
	CALL RANDOM_NUMBER (RNUMBER)
	IYEAR2=INT(RNUMBER*85)+1922
	WRITE(5,110) I+1921,IYEAR2
10	CONTINUE
	CLOSE(5)
100	FORMAT('!FILE NAME: RAN2YEAR.TABLE'/
     +	   '!RANDOMLY SELECTED 2ND YEAR OF THE TWO-YEAR POSITION',
     +	   ' ANALYSIS'/'!RANDOM YEAR GENERATION DLL IS EMBEDDED',
     +	   ' IN THE CALSIM GUI'/'!AUTHOR: HONGBING YIN'/
     +	   '!DATE: JULY 6,2010'//
     +	   '!1ST YEAR    2ND YEAR')
110	FORMAT(1X,I8,4X,I8)
	STOP
	END
