<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> 
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
    <link rel="stylesheet" type="text/css" href="../Theme/nav.css">
    <link rel="stylesheet" type="text/css" href="../LinksExt/C1H_HTML.css">
    <link rel="stylesheet" type="text/css" href="../LinksExt/Ch8-Scripting.css">
    <meta name="Generator" content="ComponentOne Doc-To-Help v.2009.2.0.480">
    <meta name="D2HTheme" content="(Default) v.21">
    <title>Screen for Erroneous Values Based on Forward Moving Average</title>
  </head>
  <body relpart="../" background-color="transparent" style=
  " margin-left: 0px; padding-bottom: 0px; margin-top: 0px; padding-right: 0px; margin-bottom: 0px; margin-right: 0px; padding-left: 0px; padding-top: 0px;">
    <div id="nsbanner" style=
    " padding-bottom: 0px; padding-right: 0px; left: 0px; padding-left: 0px; padding-top: 0px;">
      <div id="TitleRow" style=
      " padding-bottom: 4px; padding-right: 10px; padding-left: 22px; padding-top: 4px; width: 100%;">
        <div id="ienav">
          <p align="left" class="linknav">
             <a id="D2HPrevious" class="d2hpreviousenabled" href=
            "screenforerroneousvaluesbasedondurationmagnitude1.htm">Previous</a> &nbsp; <a id=
            "D2HNext" class="d2hnextenabled" href=
            "screenforerroneousvaluesbasedonforwardmovingaverage3.htm">Next</a>
          </p>
        </div>
      </div>
    </div>
    <p>
       &nbsp;
    </p>
    <div id="nstext" valign="bottom" class="d2h_main_nstext" style=
    " padding-bottom: 0px; padding-right: 10px; padding-left: 22px; padding-top: 0px;">
      <div id="d2h_breadcrumbs" class="d2h_breadcrumbs">
        <a class="d2h_breadcrumbsnormal" href="scripting1.htm">Scripting</a> <font class=
        "d2h_breadcrumbslinkseparator">&gt;</font> <a class="d2h_breadcrumbsnormal" href=
        "mathfunctions2.htm">Math Functions</a>
      </div>
      <div class="section1" style=" margin-top: 0pt; margin-bottom: 0pt;">
        <p style=
        " margin-left: 0pt; margin-top: 0pt; margin-bottom: 0pt; margin-right: 0pt; tab-stops: 63.0pt;">
          <br>
           <font size="5" face="SansSerif, Verdana, Arial, Helvetica"><b>Screen for Erroneous
          Values Based on Forward Moving Average</b></font><br>
          <br>
           <code>screenWithForwardMovingAverage<font style=" font-weight: normal;">(integer
          numberToAverageOver,</font></code>
        </p>
        <p class="bodytextindent155" style=" margin-left: 0.0px; margin-top: 0pt;">
           <code><font style=" font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; floating-point
          changeLimit)</font></code>
        </p>
        <p class="bodytextindent155" style=" margin-left: 0.0px; margin-top: 0pt;">
           &nbsp;
        </p>
        <p class="bodytextindent155" style=" margin-left: 0.0px; margin-top: 0pt;">
           Flag values in time series exceeding maximum change from a forward moving average. A
          running forward moving average of valid values is progressively computed over
          numberToAverageOver points.&nbsp; Values exceeding the moving average computed for the
          preceeding point location by more than changeLimit are flagged or set to the "Missing"
          value depending upon the settings for setInvalidToMissingValue or
          qualityFlagForInvalidValue parameters. Values failing the quality test are excluded from
          the forward moving average computation for the subsequent points. The maximum change
          comparison is done only when consecutive values are not flagged.
        </p>
        <p class="bodytextindent155" style=" margin-left: 0.0px; margin-top: 0pt;">
           &nbsp;
        </p>
        <p class="bodytextindent155" style=" margin-left: 0.0px; margin-top: 0pt;">
           <b>Parameters:&nbsp;&nbsp;</b>
        </p>
        <p class="bodytextindent155" style=
        " margin-left: 28.0px; margin-top: 0pt; margin-bottom: 0pt; margin-right: 0pt;">
           numberToAverageOver - the number of values to average over for computing the forward
          moving average.&nbsp; Must be greater than 2.
        </p>
        <p class="bodytextindent155" style=
        " margin-left: 28.0px; margin-top: 0pt; margin-bottom: 0pt; margin-right: 0pt;">
           changeLimit - allowed deviation in the tested value from the forward moving average.
        </p>
        <p class="bodytextindent155" style=" margin-left: 0.0px; margin-top: 0pt;">
           <b>Example:</b>
        </p>
        <p class="bodytextindent155" style=" margin-left: 0.0px; margin-top: 0pt;">
           &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>screenedData =
          tsData.screenWithForwardMovingAverage(</code>
        </p>
        <p class="bodytextindent155" style=
        " margin-left: 28.0px; margin-top: 0pt; margin-bottom: 0pt; margin-right: 0pt;">
           <code>integer numberToAverageOver,</code>
        </p>
        <p class="bodytextindent155" style=
        " margin-left: 28.0px; margin-top: 0pt; margin-bottom: 0pt; margin-right: 0pt;">
           <code>floating-point changeLimit)</code>
        </p>
        <p class="bodytextindent155" style=" margin-left: 0.0px; margin-top: 0pt;">
           <b>Returns:</b>&nbsp; a copy of the time series with values failing the quality test set
          to undefined and with the quality flag set to missing.<a name=
          "ScreenWithForwardMovingAverage"></a><a name="_Toc104616495"></a><a name=
          "_Toc104610546"></a><a name="_Toc101758605"></a><a name="_Toc100980972"></a><a name=
          "_Toc100728654"></a><a name="_Toc100728341"></a>
        </p>
      </div>
    </div>
  </body>
</html>
